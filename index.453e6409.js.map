{"mappings":"AAEmBA,SAASC,cAAc,iBAA1C,MACMC,EAAiBF,SAASC,cAAc,eAEjCE,EAAS,mCACtB,IACIC,EACAC,EACAC,EAHAC,EAAO,EAKX,MAAMC,IAAEC,GAAQC,QAIHC,EAAaC,GAEjBC,MAAMD,GACVE,MAAKC,GAEGA,EAAIC,SAEZC,OAAMC,GAAST,EAAIS,KAaXC,EAAgB,KAC3Bd,EAAO,kEACsDF,UAAeI,IAErEI,EAAWN,GAAMS,MAAKC,IAC3BX,EAAaW,EAAIK,YACjBd,EAAcS,EAAIM,QAwDf,SAAuBC,EAAYC,GACxC,IAGIC,EAHAC,EAAQ,GACRC,EAAaH,EAAO,EACpBI,EAAYJ,EAAO,EAGnBA,EAAO,IACTE,GAAS,qIAMX,GAAIH,EAAa,EAAG,CACdC,EAAO,IACTE,GAAS,4EACLF,EAAO,IACTE,GAAS,2EAITF,IAASD,GAEFC,IAASD,EAAa,KAD/BI,GAA0B,GAIf,IAATH,EACFI,GAAwB,EACfJ,GAAaA,GAAQ,GAC9BI,GAAwB,EACxBD,GAA0B,GACjBH,IAASD,EAAa,IAC/BI,GAA0B,EAC1BC,GAAwB,GAG1B,IAAK,IAAIC,EAAaF,EAAYE,GAAcD,EAAWC,IACrDA,EAAaN,IAGbM,EAAa,IACfA,GAA0B,GAET,IAAfA,IACFA,GAA0B,GAI1BJ,EADED,GAAQK,EACC,8BAEA,GAEbH,GAAS,kBAAkBD,kDAAyDI,MAAeA,cAEjGL,EAAOD,EAAa,IAClBC,EAAOD,EAAa,IACtBG,GAAS,yEAEXA,GAAS,+DAA+DH,MAAeA,aAE3F,MAGE,IAAK,IAAIM,EAAa,EAAGA,GAAcN,EAAYM,IAE/CJ,EADED,GAAQK,EACC,8BAEA,GAEbH,GAAS,kBAAkBD,kDAAyDI,MAAeA,aAInGL,EAAOD,IACTG,GAAS,uIAKXvB,EAAe2B,UAAYJ,CAC7B,CArIIK,CAAc1B,EAAYG,EAAA,KAK9BY,IAmJAjB,EAAe6B,iBAAiB,SAjBbC,IACjB,MAAMC,EAAOjC,SAASC,cAAc,mCAC9BiC,EAAOlC,SAASC,cAAc,oCAEhC+B,EAAEG,SAAWF,IACf1B,IACAY,KAEEa,EAAEG,SAAWD,IACf3B,IACAY,KAEoB,WAAlBa,EAAEG,OAAOC,OACX7B,EAAO8B,OAAOL,EAAEG,OAAOG,QAAQf,MAC/BJ,IACF","sources":["src/js/mainpage.js"],"sourcesContent":["'use strict';\n// import { hideSpinner, showSpinner } from './spinner';\nconst filmGalery = document.querySelector('.gallery__box');\nconst paginationList = document.querySelector('.pagination');\n\nexport const APIKEY = 'cd99a2449e6daaffb205ea92bac682a0';\nlet page = 1;\nlet totalPages;\nlet link;\nlet filmsOnPage;\n\nconst { log } = console;\n\n// Fetch films from API\n\nexport const fetchFilms = link => {\n  // showSpinner();\n  return fetch(link)\n    .then(res => {\n      // hideSpinner();\n      return res.json();\n    })\n    .catch(error => log(error));\n};\n// This function uses the film id to get the details of that film\n// Can be used to make a modal with film details\nexport const getFilmDetails = async id => {\n  link = `https://api.themoviedb.org/3/movie/${id}?api_key=${APIKEY}`;\n\n  return await fetchFilms(link).then(res => {\n    return res;\n  });\n};\n\n// Main function that loads tranding film on main page\nexport const trendingFilms = () => {\n  link = `\n    https://api.themoviedb.org/3/trending/movie/week?api_key=${APIKEY}&page=${page}`;\n\n  return fetchFilms(link).then(res => {\n    totalPages = res.total_pages;\n    filmsOnPage = res.results;\n\n    // createfilmGalery(filmsOnPage);\n    createButtons(totalPages, page);\n  });\n};\n\n// call the function\ntrendingFilms();\n\n// This function creates elements in .gallery_box\n// It can be used in other parts of the website,\n// but the html element definded by variable \"filmGalery\" -const filmGalery = document.querySelector('.gallery__box') must be there\n\nexport const createfilmGalery = elem => {\n  filmGalery.innerHTML = '';\n  elem.map(async film => {\n    let name = film.title;\n    let poster = film.poster_path;\n    let filmId = film.id;\n    let releseDate = film.release_date.slice(0, 4) || 'Sorry. No relase date yet.';\n    let other;\n    let newGenres;\n    // Because i can't get the genres names from first fetch\n    // i created second fetch from API that uses film id to get films details and then i extract genres names from it\n    let genres = await getFilmDetails(film.id).then(res => res.genres.map(elem => elem.name));\n\n    if (genres.length > 2) {\n      newGenres = genres.slice(0, 2).join(', ');\n      other = ', Other';\n    } else if (genres.length <= 2 && genres.length > 1) {\n      newGenres = genres;\n      other = '';\n      if (genres.length === 2) {\n        newGenres = genres.join(', ');\n        other = '';\n      }\n    } else {\n      newGenres = 'Sorry. No genre added yet.';\n      other = '';\n    }\n\n    const galeryItem = `<figure class=\"card\" data-id=\"${filmId}\">\n<img class=\"card__image\" src=\"https://image.tmdb.org/t/p/w500${poster}\" alt=\"${name} movie poster\" />\n<figcaption class=\"card__caption\">\n  <p class=\"card__title\">${name}</p>\n  <p class=\"card__description\">${newGenres + other} | ${releseDate}</p>\n</figcaption>\n</figure>`;\n\n    filmGalery.innerHTML = filmGalery.innerHTML + galeryItem;\n  });\n};\n\n// Pagination\n\nexport function createButtons(totalPages, page) {\n  let liTag = '';\n  let beforePage = page - 1;\n  let afterPage = page + 1;\n  let activeLi;\n\n  if (page > 1) {\n    liTag += `<button class=\"pagination__button--arrow-left\">\n  <i style=\"pointer-events: none\" class=\"fa-solid fa-arrow-left\"></i>\n</button>`;\n  }\n\n  // if there's more then 6 page\n  if (totalPages > 6) {\n    if (page > 3) {\n      liTag += `<button class=\"pagination__button\" type=\"button\" data-page=\"1\">1</button>`;\n      if (page > 4) {\n        liTag += `<span class=\"pagination__hidden-results\">&middot&middot&middot</span>`;\n      }\n    }\n\n    if (page === totalPages) {\n      beforePage = beforePage - 1;\n    } else if (page === totalPages - 1) {\n      beforePage = beforePage - 1;\n    }\n    if (page === 1) {\n      afterPage = afterPage + 2;\n    } else if (page => 2 && page <= 4) {\n      afterPage = afterPage + 1;\n      beforePage = beforePage - 1;\n    } else if (page === totalPages + 1) {\n      beforePage = beforePage + 3;\n      afterPage = afterPage + 1;\n    }\n\n    for (let pageLength = beforePage; pageLength <= afterPage; pageLength++) {\n      if (pageLength > totalPages) {\n        continue;\n      }\n      if (pageLength < 0) {\n        pageLength = pageLength + 2;\n      }\n      if (pageLength === 0) {\n        pageLength = pageLength + 1;\n      }\n\n      if (page == pageLength) {\n        activeLi = 'pagination__button--current';\n      } else {\n        activeLi = '';\n      }\n      liTag += `<button class=\"${activeLi} pagination__button\" type=\"button\" data-page=\"${pageLength}\">${pageLength}</button>`;\n    }\n    if (page < totalPages - 2) {\n      if (page < totalPages - 3) {\n        liTag += `<span class=\"pagination__hidden-results\">&middot&middot&middot</span>`;\n      }\n      liTag += `<button class=\"pagination__button\" type=\"button\" data-page=\"${totalPages}\">${totalPages}</button>`;\n    }\n  }\n  // if there's less then 6 page\n  else {\n    for (let pageLength = 1; pageLength <= totalPages; pageLength++) {\n      if (page == pageLength) {\n        activeLi = 'pagination__button--current';\n      } else {\n        activeLi = '';\n      }\n      liTag += `<button class=\"${activeLi} pagination__button\" type=\"button\" data-page=\"${pageLength}\">${pageLength}</button>`;\n    }\n  }\n\n  if (page < totalPages) {\n    liTag += `<button class=\"pagination__button--arrow-right\">\n  <i style=\"pointer-events: none\" class=\"fa-solid fa-arrow-right\"></i>\n</button>`;\n  }\n\n  paginationList.innerHTML = liTag;\n}\n\nconst chceckBttn = e => {\n  const prev = document.querySelector('.pagination__button--arrow-left');\n  const next = document.querySelector('.pagination__button--arrow-right');\n\n  if (e.target === prev) {\n    page--;\n    trendingFilms();\n  }\n  if (e.target === next) {\n    page++;\n    trendingFilms();\n  }\n  if (e.target.type === 'button') {\n    page = Number(e.target.dataset.page);\n    trendingFilms();\n  }\n};\npaginationList.addEventListener('click', chceckBttn);\n"],"names":["document","querySelector","$ea57b9b9d4f165e5$var$paginationList","$ea57b9b9d4f165e5$export$8aa241ee05ce92b7","$ea57b9b9d4f165e5$var$totalPages","$ea57b9b9d4f165e5$var$link","$ea57b9b9d4f165e5$var$filmsOnPage","$ea57b9b9d4f165e5$var$page","log","$ea57b9b9d4f165e5$var$log","console","$ea57b9b9d4f165e5$export$651946d2de0aa03","link","fetch","then","res","json","catch","error","$ea57b9b9d4f165e5$export$8fa3752a2ece8db3","total_pages","results","totalPages","page","activeLi","liTag","beforePage","afterPage","pageLength","innerHTML","$ea57b9b9d4f165e5$export$cf36c158a653a556","addEventListener","e","prev","next","target","type","Number","dataset"],"version":3,"file":"index.453e6409.js.map"}